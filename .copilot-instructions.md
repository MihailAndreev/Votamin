# Votamin

Votamin is a survey and poll builder app built with JS and Supabase. Users register/login, create polls, add questions and options, publish polls and share a public voting link. Poll creators can manage their polls (create / edit / publish / close / delete) and track results. Respondents can vote via a public link when the poll is published. The app includes an admin panel (V1) for basic administration.

## Architecture

Classical client-server app:
 - Front-end: JS app, Bootstrap, HTML, CSS
 - Back-end: Supabase
 - Database: PostgreSQL
 - Authentication: Supabase Auth
 - Build tools: Vite, npm
 - API: Supabase REST API
 - Hosting: Netlify
 - Source code: GitHub

## Modular Design

Use modular code structure, with separate files for different components, pages and features. Use ES6 modules to organize the code.

Recommended modules:
 - auth (register, login, logout, session handling)
 - router (routes, guards, navigation)
 - polls (CRUD polls, publish, close)
 - questions (CRUD questions, ordering)
 - options (CRUD options, ordering)
 - responses (submit vote, results aggregation)
 - admin (admin-only features)
 - ui (layout components, forms, validation, toasts, loaders)

## UI Guidelines

 - Use HTML, CSS, Bootstrap and vanilla JS for the front-end.
 - Use Bootstrap components and utilities to create a responsive and user-friendly interface.
 - Implement modern responsive UI design with semantic HTML and CSS.
 - Use a consistent color scheme and typography.
 - Use appropriate icons, effects and visual cues to enhance usability.
 - Provide clear UX states for loading, empty lists, errors, success actions and form validation.

## Pages and navigation

 - Split the app into multiple pages: landing, login, registration, dashboard, poll list, poll create, poll edit, poll vote (public), poll results, admin panel.
 - Implement pages as reusable components (HTML, CSS and JS code).
 - Use routing to navigate between pages.
 - Use full URLs like /, /login, /register, /dashboard, /polls, /polls/create, /polls/{id}/edit, /polls/{id}/results, /p/{publicCode}, /admin etc.

Routing rules:
 - Use guards to restrict access to authenticated-only pages.
 - Prevent logged-in users from accessing /login and /register.
 - Public vote pages must be accessible without authentication when the poll is published.
 - Admin panel must be accessible only for users with admin role.

## Backend and Database

 - Use Supabase as the backend and database for the app.
 - Use PostgreSQL as the database with tables for polls, questions, options, responses, answers and user_roles.
 - Use Supabase Storage for file uploads if needed.
 - When changing the database schema, always use migrations to keep track of changes.
 - Add comments in SQL files for migrations to explain the purpose of each change and the reasoning behind it.
 - After applying migration in Supabase, keep a copy of the migration SQL file in the project repository for reference and version control.

## Authentication and Authorization

 - Use Supabase Auth for user authentication and authorization.
 - Implement RLS policies to restrict access to data based on poll ownership and user roles.
 - Implement user roles with a separate table in the database: `user_roles` + enum `roles` (admin, user).
 - Enforce one vote per authenticated user per poll via database constraints or application logic.